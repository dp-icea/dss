<source>
  @type   forward
  port    24224
  bind    0.0.0.0
</source>
 
<filter dss.logs>
  @type     parser
  key_name  msg
  format    json
</filter>

<filter dss.logs>
  @type     record_transformer
  <record>
    tag ${tag}
  </record>
</filter>

<match fluent.*>
  @type     null
</match>

<match **.*>
  @type     stdout
</match>


<match **.*>
  @type     file
   path     /output/test
</match>

<match dss.logs>
  @type     opensearch
  host      "#{ENV['OPENSEARCH_HOST']}"
  port      "#{ENV['OPENSEARCH_PORT']}"
  scheme    http
  user      "#{ENV['USER']}"
  password  "#{ENV['PASSWORD']}"
  index_name          fluentd
  reconnect_on_error  true
  reload_on_failure   true
</match>

<system>
log_level error
  <log>
    format json
    time_format %Y-%m-%d
  </log>
</system>